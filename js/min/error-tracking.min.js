!function(){"use strict";const r={errors:[],maxErrors:50,sessionId:null,init:function(){this.sessionId=this.getSessionId(),this.setupErrorHandlers(),this.trackConsoleErrors(),this.trackNetworkErrors(),this.setupErrorReporting()},getSessionId:function(){return sessionStorage.getItem("errorTrackingSession")||this.createSession()},createSession:function(){const r=Date.now().toString(36)+Math.random().toString(36).substr(2);return sessionStorage.setItem("errorTrackingSession",r),r},setupErrorHandlers:function(){const self=this;window.addEventListener("error",function(r){self.trackError({type:"javascript",message:r.message,source:r.filename,lineno:r.lineno,colno:r.colno,stack:r.error?r.error.stack:null,timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href})}),window.addEventListener("unhandledrejection",function(r){self.trackError({type:"unhandled_promise",message:r.reason?r.reason.toString():"Unhandled Promise Rejection",reason:r.reason,promise:r.promise,timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href})})},trackConsoleErrors:function(){const self=this,r=console.error;console.error=function(){const t=Array.prototype.slice.call(arguments).map(r=>{if("object"==typeof r)try{return JSON.stringify(r)}catch(t){return r.toString()}return r}).join(" ");self.trackError({type:"console",message:t,timestamp:Date.now(),url:window.location.href}),r.apply(console,arguments)}},trackNetworkErrors:function(){const self=this,r=window.fetch;window.fetch=function(){const t=arguments;return r.apply(this,t).then(function(r){return r.ok||self.trackError({type:"network",subtype:"fetch",status:r.status,statusText:r.statusText,url:t[0],timestamp:Date.now(),pageUrl:window.location.href}),r}).catch(function(r){throw self.trackError({type:"network",subtype:"fetch_failed",message:r.message,url:t[0],timestamp:Date.now(),pageUrl:window.location.href}),r})};const t=XMLHttpRequest.prototype.open,e=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(){this._url=arguments[1],this._method=arguments[0],t.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){const r=this,t=r.onreadystatechange;r.onreadystatechange=function(){4===r.readyState&&r.status>=400&&self.trackError({type:"network",subtype:"xhr",status:r.status,statusText:r.statusText,method:r._method,url:r._url,timestamp:Date.now(),pageUrl:window.location.href}),t&&t.apply(r,arguments)},e.apply(this,arguments)}},trackError:function(r){r.sessionId=this.sessionId,r.viewport={width:window.innerWidth,height:window.innerHeight},r.screen={width:window.screen.width,height:window.screen.height},window.performance&&window.performance.memory&&(r.memory={used:Math.round(window.performance.memory.usedJSHeapSize/1048576),total:Math.round(window.performance.memory.totalJSHeapSize/1048576),limit:Math.round(window.performance.memory.jsHeapSizeLimit/1048576)}),this.errors.push(r),this.errors.length>this.maxErrors&&this.errors.shift(),this.saveErrors(),this.reportError(r),"localhost"===window.location.hostname&&console.warn("Error tracked:",r)},saveErrors:function(){try{localStorage.setItem("trackedErrors",JSON.stringify(this.errors))}catch(r){console.warn("Error storage quota exceeded")}},loadErrors:function(){try{const r=localStorage.getItem("trackedErrors");r&&(this.errors=JSON.parse(r))}catch(r){console.warn("Failed to load stored errors")}},reportError:function(r){window.gtag&&window.gtag("event","exception",{description:r.message||r.type,fatal:"javascript"===r.type,error_type:r.type,error_source:r.source||"unknown"});const t=this.getErrorKey(r),e=this.getErrorCount(t);1!==e&&10!==e&&100!==e||this.sendErrorReport(r,e)},getErrorKey:function(r){return[r.type,r.message,r.source,r.lineno].filter(Boolean).join("|")},getErrorCount:function(r){const t=JSON.parse(sessionStorage.getItem("errorCounts")||"{}");return t[r]=(t[r]||0)+1,sessionStorage.setItem("errorCounts",JSON.stringify(t)),t[r]},sendErrorReport:function(r,t){Date.now(),window.location.hostname},setupErrorReporting:function(){const self=this;window.addEventListener("beforeunload",function(){if(self.errors.length>0){const r={sessionId:self.sessionId,errorCount:self.errors.length,errors:self.errors.slice(-10),timestamp:Date.now()};navigator.sendBeacon&&new Blob([JSON.stringify(r)],{type:"application/json"})}})},getErrors:function(){return this.errors},clearErrors:function(){this.errors=[],localStorage.removeItem("trackedErrors"),sessionStorage.removeItem("errorCounts")},getErrorSummary:function(){const r={};return this.errors.forEach(function(t){const e=t.type;r[e]=r[e]||{count:0,errors:[]},r[e].count++,r[e].errors.length<5&&r[e].errors.push({message:t.message,timestamp:t.timestamp})}),r}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){r.init()}):r.init(),window.ErrorTracker=r}();