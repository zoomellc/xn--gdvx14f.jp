!function(){"use strict";class n{constructor(){this.entries=[],this.filteredEntries=[],this.categories={},this.types={},this.currentFilter={search:"",category:"all",type:"all",tags:[]},this.favorites=[],this.history=[],this.storageKey="keigo-jp-dictionary",this.init()}async init(){try{await this.loadDictionaryData(),this.loadUserData(),this.setupUI(),this.attachEventListeners(),this.updateDisplay()}catch(n){console.error("Failed to initialize dictionary:",n),this.showError("辞書の初期化に失敗しました")}}async loadDictionaryData(){try{const n=await fetch("/data/honorific-dictionary.json");if(!n.ok)throw new Error("Failed to load dictionary data");const e=await n.json();this.entries=e.entries,this.categories=e.categories,this.types=e.types,this.filteredEntries=[...this.entries]}catch(n){throw console.error("Error loading dictionary:",n),n}}loadUserData(){const n=localStorage.getItem(this.storageKey);if(n)try{const e=JSON.parse(n);this.favorites=e.favorites||[],this.history=e.history||[]}catch(n){console.error("Failed to parse user data:",n)}}saveUserData(){const n={favorites:this.favorites,history:this.history.slice(0,50)};localStorage.setItem(this.storageKey,JSON.stringify(n))}setupUI(){this.injectStyles(),this.createDictionaryContainer()}injectStyles(){const n=document.createElement("style");n.textContent="\n                .honorific-dictionary {\n                    max-width: 1200px;\n                    margin: 0 auto;\n                    padding: 20px;\n                    font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n                }\n                \n                .dictionary-header {\n                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n                    color: white;\n                    padding: 30px;\n                    border-radius: 10px;\n                    margin-bottom: 30px;\n                    text-align: center;\n                }\n                \n                .dictionary-title {\n                    font-size: 2.5em;\n                    margin: 0 0 10px 0;\n                    font-weight: bold;\n                }\n                \n                .dictionary-subtitle {\n                    font-size: 1.1em;\n                    opacity: 0.9;\n                }\n                \n                .dictionary-controls {\n                    background: var(--bg-color, #f8f9fa);\n                    padding: 20px;\n                    border-radius: 10px;\n                    margin-bottom: 20px;\n                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n                }\n                \n                .search-container {\n                    position: relative;\n                    margin-bottom: 15px;\n                }\n                \n                .dictionary-search {\n                    width: 100%;\n                    padding: 12px 40px 12px 15px;\n                    font-size: 16px;\n                    border: 2px solid #e0e0e0;\n                    border-radius: 8px;\n                    transition: border-color 0.3s;\n                }\n                \n                .dictionary-search:focus {\n                    outline: none;\n                    border-color: #667eea;\n                }\n                \n                .search-icon {\n                    position: absolute;\n                    right: 12px;\n                    top: 50%;\n                    transform: translateY(-50%);\n                    color: #999;\n                }\n                \n                .filter-container {\n                    display: flex;\n                    gap: 15px;\n                    flex-wrap: wrap;\n                }\n                \n                .filter-select {\n                    flex: 1;\n                    min-width: 150px;\n                    padding: 10px;\n                    border: 2px solid #e0e0e0;\n                    border-radius: 6px;\n                    font-size: 14px;\n                    background: white;\n                    cursor: pointer;\n                }\n                \n                .dictionary-stats {\n                    text-align: center;\n                    color: #666;\n                    margin-bottom: 20px;\n                    font-size: 14px;\n                }\n                \n                .dictionary-content {\n                    display: grid;\n                    gap: 15px;\n                }\n                \n                .dictionary-entry {\n                    background: var(--bg-color, white);\n                    border: 1px solid #e0e0e0;\n                    border-radius: 10px;\n                    padding: 20px;\n                    transition: all 0.3s ease;\n                    position: relative;\n                }\n                \n                .dictionary-entry:hover {\n                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n                    transform: translateY(-2px);\n                }\n                \n                .entry-header {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: start;\n                    margin-bottom: 15px;\n                }\n                \n                .entry-word {\n                    font-size: 1.8em;\n                    font-weight: bold;\n                    color: #333;\n                    margin: 0;\n                }\n                \n                .entry-reading {\n                    font-size: 1em;\n                    color: #666;\n                    margin-left: 10px;\n                }\n                \n                .entry-actions {\n                    display: flex;\n                    gap: 10px;\n                }\n                \n                .entry-action-btn {\n                    background: none;\n                    border: none;\n                    cursor: pointer;\n                    padding: 8px;\n                    border-radius: 50%;\n                    transition: background-color 0.3s;\n                    color: #666;\n                }\n                \n                .entry-action-btn:hover {\n                    background-color: rgba(0,0,0,0.05);\n                }\n                \n                .entry-action-btn.favorite.active {\n                    color: #f59e0b;\n                }\n                \n                .entry-metadata {\n                    display: flex;\n                    gap: 10px;\n                    margin-bottom: 15px;\n                    flex-wrap: wrap;\n                }\n                \n                .entry-category, .entry-tag {\n                    display: inline-block;\n                    padding: 4px 12px;\n                    border-radius: 20px;\n                    font-size: 12px;\n                    font-weight: 500;\n                }\n                \n                .entry-category {\n                    background: #e3f2fd;\n                    color: #1976d2;\n                }\n                \n                .entry-tag {\n                    background: #f3e5f5;\n                    color: #7b1fa2;\n                }\n                \n                .entry-meaning {\n                    font-size: 14px;\n                    color: #666;\n                    margin-bottom: 20px;\n                    line-height: 1.6;\n                }\n                \n                .entry-forms {\n                    display: grid;\n                    gap: 15px;\n                }\n                \n                .form-section {\n                    background: var(--bg-secondary, #f8f9fa);\n                    padding: 15px;\n                    border-radius: 8px;\n                }\n                \n                .form-type {\n                    font-weight: bold;\n                    color: #333;\n                    margin-bottom: 8px;\n                    display: flex;\n                    align-items: center;\n                    gap: 8px;\n                }\n                \n                .form-type-icon {\n                    width: 20px;\n                    height: 20px;\n                    border-radius: 50%;\n                    display: inline-flex;\n                    align-items: center;\n                    justify-content: center;\n                    font-size: 12px;\n                    color: white;\n                }\n                \n                .form-type-icon.respectful {\n                    background: #4caf50;\n                }\n                \n                .form-type-icon.humble {\n                    background: #ff9800;\n                }\n                \n                .form-type-icon.polite {\n                    background: #2196f3;\n                }\n                \n                .form-list {\n                    display: flex;\n                    flex-wrap: wrap;\n                    gap: 8px;\n                    margin-bottom: 8px;\n                }\n                \n                .form-item {\n                    background: white;\n                    padding: 6px 12px;\n                    border-radius: 6px;\n                    border: 1px solid #e0e0e0;\n                    font-size: 14px;\n                    cursor: pointer;\n                    transition: all 0.2s;\n                }\n                \n                .form-item:hover {\n                    background: #667eea;\n                    color: white;\n                    border-color: #667eea;\n                }\n                \n                .form-usage {\n                    font-size: 13px;\n                    color: #666;\n                    margin-bottom: 8px;\n                    font-style: italic;\n                }\n                \n                .form-examples {\n                    font-size: 13px;\n                    color: #555;\n                    line-height: 1.6;\n                }\n                \n                .example-item {\n                    padding: 4px 0;\n                    border-left: 3px solid #667eea;\n                    padding-left: 12px;\n                    margin-bottom: 4px;\n                }\n                \n                .entry-notes {\n                    margin-top: 15px;\n                    padding: 12px;\n                    background: #fff3cd;\n                    border-radius: 6px;\n                    font-size: 13px;\n                    color: #856404;\n                }\n                \n                .entry-related {\n                    margin-top: 15px;\n                    font-size: 13px;\n                }\n                \n                .related-words {\n                    display: flex;\n                    flex-wrap: wrap;\n                    gap: 6px;\n                    margin-top: 5px;\n                }\n                \n                .related-word {\n                    background: #e8eaf6;\n                    color: #3f51b5;\n                    padding: 4px 10px;\n                    border-radius: 4px;\n                    cursor: pointer;\n                    transition: background-color 0.2s;\n                }\n                \n                .related-word:hover {\n                    background: #c5cae9;\n                }\n                \n                .dictionary-empty {\n                    text-align: center;\n                    padding: 60px 20px;\n                    color: #999;\n                }\n                \n                .dictionary-empty-icon {\n                    font-size: 48px;\n                    margin-bottom: 20px;\n                }\n                \n                .dictionary-empty-text {\n                    font-size: 18px;\n                    margin-bottom: 10px;\n                }\n                \n                .dictionary-empty-hint {\n                    font-size: 14px;\n                    color: #666;\n                }\n                \n                .dictionary-loading {\n                    text-align: center;\n                    padding: 40px;\n                    color: #666;\n                }\n                \n                .dictionary-error {\n                    text-align: center;\n                    padding: 40px;\n                    color: #d32f2f;\n                    background: #ffebee;\n                    border-radius: 8px;\n                }\n                \n                .copy-notification {\n                    position: fixed;\n                    bottom: 20px;\n                    left: 50%;\n                    transform: translateX(-50%);\n                    background: #333;\n                    color: white;\n                    padding: 12px 24px;\n                    border-radius: 6px;\n                    font-size: 14px;\n                    opacity: 0;\n                    transition: opacity 0.3s;\n                    pointer-events: none;\n                    z-index: 1000;\n                }\n                \n                .copy-notification.show {\n                    opacity: 1;\n                }\n                \n                @media (max-width: 768px) {\n                    .honorific-dictionary {\n                        padding: 10px;\n                    }\n                    \n                    .dictionary-header {\n                        padding: 20px;\n                    }\n                    \n                    .dictionary-title {\n                        font-size: 2em;\n                    }\n                    \n                    .filter-container {\n                        flex-direction: column;\n                    }\n                    \n                    .entry-word {\n                        font-size: 1.5em;\n                    }\n                }\n                \n                @media (prefers-color-scheme: dark) {\n                    .honorific-dictionary {\n                        --bg-color: #1e1e1e;\n                        --bg-secondary: #2a2a2a;\n                        color: #e0e0e0;\n                    }\n                    \n                    .dictionary-controls {\n                        background: var(--bg-secondary);\n                    }\n                    \n                    .dictionary-search,\n                    .filter-select {\n                        background: var(--bg-color);\n                        color: #e0e0e0;\n                        border-color: #444;\n                    }\n                    \n                    .dictionary-entry {\n                        background: var(--bg-secondary);\n                        border-color: #444;\n                    }\n                    \n                    .entry-word {\n                        color: #e0e0e0;\n                    }\n                    \n                    .form-item {\n                        background: var(--bg-color);\n                        border-color: #555;\n                        color: #e0e0e0;\n                    }\n                    \n                    .form-item:hover {\n                        background: #667eea;\n                        color: white;\n                    }\n                }\n            ",document.head.appendChild(n)}createDictionaryContainer(){const n=document.querySelector(".honorific-dictionary-container");n&&(n.innerHTML=`\n                <div class="honorific-dictionary">\n                    <div class="dictionary-header">\n                        <h1 class="dictionary-title">敬語辞書</h1>\n                        <p class="dictionary-subtitle">敬語の正しい使い方を調べることができます</p>\n                    </div>\n                    \n                    <div class="dictionary-controls">\n                        <div class="search-container">\n                            <input type="text" class="dictionary-search" placeholder="単語を検索...">\n                            <span class="search-icon">🔍</span>\n                        </div>\n                        \n                        <div class="filter-container">\n                            <select class="filter-select filter-category">\n                                <option value="all">すべてのカテゴリ</option>\n                                ${Object.entries(this.categories).map(([n,e])=>`<option value="${n}">${n}</option>`).join("")}\n                            </select>\n                            \n                            <select class="filter-select filter-type">\n                                <option value="all">すべての種類</option>\n                                <option value="respectful">尊敬語のみ</option>\n                                <option value="humble">謙譲語のみ</option>\n                                <option value="polite">丁寧語のみ</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class="dictionary-stats"></div>\n                    \n                    <div class="dictionary-content"></div>\n                    \n                    <div class="copy-notification">コピーしました</div>\n                </div>\n            `,this.elements={search:n.querySelector(".dictionary-search"),categoryFilter:n.querySelector(".filter-category"),typeFilter:n.querySelector(".filter-type"),stats:n.querySelector(".dictionary-stats"),content:n.querySelector(".dictionary-content"),notification:n.querySelector(".copy-notification")})}attachEventListeners(){this.elements&&(this.elements.search.addEventListener("input",n=>{this.currentFilter.search=n.target.value,this.filterEntries()}),this.elements.categoryFilter.addEventListener("change",n=>{this.currentFilter.category=n.target.value,this.filterEntries()}),this.elements.typeFilter.addEventListener("change",n=>{this.currentFilter.type=n.target.value,this.filterEntries()}),document.addEventListener("keydown",n=>{"/"===n.key&&"INPUT"!==n.target.tagName&&(n.preventDefault(),this.elements.search.focus())}))}filterEntries(){const{search:n,category:e,type:t}=this.currentFilter;this.filteredEntries=this.entries.filter(i=>{if(n){const e=n.toLowerCase(),t=i.word.includes(e),o=i.reading.includes(e),r=i.meaning.includes(e),a=i.tags.some(n=>n.includes(e));if(!(t||o||r||a))return!1}if("all"!==e&&i.category!==e)return!1;if("all"!==t){if("respectful"===t&&(!i.respectful||0===i.respectful.forms.length))return!1;if("humble"===t&&(!i.humble||0===i.humble.forms.length))return!1;if("polite"===t&&(!i.polite||0===i.polite.forms.length))return!1}return!0}),this.updateDisplay()}updateDisplay(){this.elements&&(this.elements.stats.textContent=`${this.filteredEntries.length}件の結果`,0!==this.filteredEntries.length?(this.elements.content.innerHTML=this.filteredEntries.map(n=>this.createEntryHTML(n)).join(""),this.attachEntryEventListeners()):this.elements.content.innerHTML='\n                    <div class="dictionary-empty">\n                        <div class="dictionary-empty-icon">📚</div>\n                        <div class="dictionary-empty-text">該当する単語が見つかりません</div>\n                        <div class="dictionary-empty-hint">別のキーワードで検索してみてください</div>\n                    </div>\n                ')}createEntryHTML(n){const e=this.favorites.includes(n.id);return`\n                <div class="dictionary-entry" data-id="${n.id}">\n                    <div class="entry-header">\n                        <div>\n                            <span class="entry-word">${n.word}</span>\n                            <span class="entry-reading">${n.reading}</span>\n                        </div>\n                        <div class="entry-actions">\n                            <button class="entry-action-btn favorite ${e?"active":""}" \n                                    title="お気に入り" data-id="${n.id}">\n                                ${e?"★":"☆"}\n                            </button>\n                            <button class="entry-action-btn copy" title="コピー" data-word="${n.word}">\n                                📋\n                            </button>\n                            <button class="entry-action-btn speak" title="読み上げ" data-text="${n.word}">\n                                🔊\n                            </button>\n                        </div>\n                    </div>\n                    \n                    <div class="entry-metadata">\n                        <span class="entry-category">${n.category}</span>\n                        ${n.tags.map(n=>`<span class="entry-tag">${n}</span>`).join("")}\n                    </div>\n                    \n                    <div class="entry-meaning">${n.meaning}</div>\n                    \n                    <div class="entry-forms">\n                        ${n.respectful&&n.respectful.forms.length>0?`\n                            <div class="form-section">\n                                <div class="form-type">\n                                    <span class="form-type-icon respectful">尊</span>\n                                    尊敬語\n                                </div>\n                                <div class="form-list">\n                                    ${n.respectful.forms.map(n=>`<span class="form-item" data-text="${n}">${n}</span>`).join("")}\n                                </div>\n                                ${n.respectful.usage?`<div class="form-usage">${n.respectful.usage}</div>`:""}\n                                ${n.respectful.examples&&n.respectful.examples.length>0?`\n                                    <div class="form-examples">\n                                        ${n.respectful.examples.map(n=>`<div class="example-item">${n}</div>`).join("")}\n                                    </div>\n                                `:""}\n                            </div>\n                        `:""}\n                        \n                        ${n.humble&&n.humble.forms.length>0?`\n                            <div class="form-section">\n                                <div class="form-type">\n                                    <span class="form-type-icon humble">謙</span>\n                                    謙譲語\n                                </div>\n                                <div class="form-list">\n                                    ${n.humble.forms.map(n=>`<span class="form-item" data-text="${n}">${n}</span>`).join("")}\n                                </div>\n                                ${n.humble.usage?`<div class="form-usage">${n.humble.usage}</div>`:""}\n                                ${n.humble.examples&&n.humble.examples.length>0?`\n                                    <div class="form-examples">\n                                        ${n.humble.examples.map(n=>`<div class="example-item">${n}</div>`).join("")}\n                                    </div>\n                                `:""}\n                            </div>\n                        `:""}\n                        \n                        ${n.polite&&n.polite.forms.length>0?`\n                            <div class="form-section">\n                                <div class="form-type">\n                                    <span class="form-type-icon polite">丁</span>\n                                    丁寧語\n                                </div>\n                                <div class="form-list">\n                                    ${n.polite.forms.map(n=>`<span class="form-item" data-text="${n}">${n}</span>`).join("")}\n                                </div>\n                                ${n.polite.usage?`<div class="form-usage">${n.polite.usage}</div>`:""}\n                                ${n.polite.examples&&n.polite.examples.length>0?`\n                                    <div class="form-examples">\n                                        ${n.polite.examples.map(n=>`<div class="example-item">${n}</div>`).join("")}\n                                    </div>\n                                `:""}\n                            </div>\n                        `:""}\n                    </div>\n                    \n                    ${n.notes?`\n                        <div class="entry-notes">\n                            <strong>注意:</strong> ${n.notes}\n                        </div>\n                    `:""}\n                    \n                    ${n.related&&n.related.length>0?`\n                        <div class="entry-related">\n                            <strong>関連語:</strong>\n                            <div class="related-words">\n                                ${n.related.map(n=>`<span class="related-word" data-word="${n}">${n}</span>`).join("")}\n                            </div>\n                        </div>\n                    `:""}\n                </div>\n            `}attachEntryEventListeners(){document.querySelectorAll(".entry-action-btn.favorite").forEach(n=>{n.addEventListener("click",n=>{const e=n.target.dataset.id;this.toggleFavorite(e)})}),document.querySelectorAll(".entry-action-btn.copy").forEach(n=>{n.addEventListener("click",n=>{const e=n.target.dataset.word;this.copyToClipboard(e)})}),document.querySelectorAll(".entry-action-btn.speak").forEach(n=>{n.addEventListener("click",n=>{const e=n.target.dataset.text;this.speak(e)})}),document.querySelectorAll(".form-item").forEach(n=>{n.addEventListener("click",n=>{const e=n.target.dataset.text;this.copyToClipboard(e)})}),document.querySelectorAll(".related-word").forEach(n=>{n.addEventListener("click",n=>{const e=n.target.dataset.word;this.elements.search.value=e,this.currentFilter.search=e,this.filterEntries(),this.elements.search.scrollIntoView({behavior:"smooth",block:"center"})})})}toggleFavorite(n){const e=this.favorites.indexOf(n);e>-1?this.favorites.splice(e,1):this.favorites.push(n),this.saveUserData(),this.updateDisplay()}copyToClipboard(n){if(navigator.clipboard)navigator.clipboard.writeText(n).then(()=>{this.showNotification("コピーしました")}).catch(n=>{console.error("Copy failed:",n)});else{const e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();try{document.execCommand("copy"),this.showNotification("コピーしました")}catch(n){console.error("Copy failed:",n)}document.body.removeChild(e)}}speak(n){if("speechSynthesis"in window){window.speechSynthesis.cancel();const e=new SpeechSynthesisUtterance(n);e.lang="ja-JP",e.rate=.9,e.pitch=1,window.speechSynthesis.speak(e)}}showNotification(n){this.elements.notification.textContent=n,this.elements.notification.classList.add("show"),setTimeout(()=>{this.elements.notification.classList.remove("show")},2e3)}showError(n){this.elements&&this.elements.content&&(this.elements.content.innerHTML=`\n                    <div class="dictionary-error">\n                        <p>${n}</p>\n                    </div>\n                `)}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".honorific-dictionary-container")&&new n}):document.querySelector(".honorific-dictionary-container")&&new n,window.HonorificDictionary=n}();