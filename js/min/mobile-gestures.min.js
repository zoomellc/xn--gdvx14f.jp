!function(){"use strict";const t={config:{swipeThreshold:50,swipeTimeout:300,longPressThreshold:500,pinchThreshold:.02,doubleTapTimeout:300,enableVibration:!0,enableDebug:!1},touches:{startX:0,startY:0,startTime:0,startDistance:0,lastTap:0,longPressTimer:null},handlers:{swipeLeft:[],swipeRight:[],swipeUp:[],swipeDown:[],pinchIn:[],pinchOut:[],longPress:[],doubleTap:[],shake:[]},init:function(){this.isMobile()?(this.setupTouchListeners(),this.setupShakeDetection(),this.setupOrientationDetection(),this.applyMobileOptimizations(),this.log("Mobile gestures initialized")):this.log("Not a mobile device, skipping gesture initialization")},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window||navigator.maxTouchPoints>0},setupTouchListeners:function(){const t=document.body;t.addEventListener("touchstart",t=>{this.handleTouchStart(t)},{passive:!0}),t.addEventListener("touchmove",t=>{this.handleTouchMove(t)},{passive:!1}),t.addEventListener("touchend",t=>{this.handleTouchEnd(t)},{passive:!0}),t.addEventListener("touchcancel",t=>{this.clearTouchData()},{passive:!0}),this.preventDefaultGestures()},handleTouchStart:function(t){const e=t.touches[0];this.touches.startX=e.clientX,this.touches.startY=e.clientY,this.touches.startTime=Date.now(),2===t.touches.length&&(this.touches.startDistance=this.getDistance(t.touches[0],t.touches[1])),this.touches.longPressTimer=setTimeout(()=>{this.triggerLongPress(t)},this.config.longPressThreshold);const i=Date.now();i-this.touches.lastTap<this.config.doubleTapTimeout&&this.triggerDoubleTap(t),this.touches.lastTap=i},handleTouchMove:function(t){if(this.touches.longPressTimer){const e=t.touches[0],i=Math.abs(e.clientX-this.touches.startX),n=Math.abs(e.clientY-this.touches.startY);(i>10||n>10)&&(clearTimeout(this.touches.longPressTimer),this.touches.longPressTimer=null)}if(2===t.touches.length&&this.touches.startDistance>0){const e=this.getDistance(t.touches[0],t.touches[1])/this.touches.startDistance;Math.abs(1-e)>this.config.pinchThreshold&&(e>1?this.triggerPinchOut(t,e):this.triggerPinchIn(t,e),t.preventDefault())}},handleTouchEnd:function(t){if(this.touches.longPressTimer&&(clearTimeout(this.touches.longPressTimer),this.touches.longPressTimer=null),!(t.touches.length>0)){if(Date.now()-this.touches.startTime<this.config.swipeTimeout){const e=t.changedTouches[0],i=e.clientX-this.touches.startX,n=e.clientY-this.touches.startY;(Math.abs(i)>this.config.swipeThreshold||Math.abs(n)>this.config.swipeThreshold)&&(Math.abs(i)>Math.abs(n)?i>0?this.triggerSwipeRight(t):this.triggerSwipeLeft(t):n>0?this.triggerSwipeDown(t):this.triggerSwipeUp(t))}this.clearTouchData()}},clearTouchData:function(){this.touches.startX=0,this.touches.startY=0,this.touches.startTime=0,this.touches.startDistance=0,this.touches.longPressTimer&&(clearTimeout(this.touches.longPressTimer),this.touches.longPressTimer=null)},getDistance:function(t,e){const i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)},setupShakeDetection:function(){if(!window.DeviceMotionEvent)return;let t=0,e=0,i=0,n=0;window.addEventListener("devicemotion",s=>{const o=s.accelerationIncludingGravity;if(!o)return;const r=Date.now();r-n>100&&(n=r,Math.abs(o.x-t)+Math.abs(o.y-e)+Math.abs(o.z-i)>15&&this.triggerShake(s),t=o.x,e=o.y,i=o.z)})},setupOrientationDetection:function(){let t=window.orientation;window.addEventListener("orientationchange",()=>{const e=window.orientation;this.handleOrientationChange(t,e),t=e})},applyMobileOptimizations:function(){document.body.classList.add("is-mobile"),this.optimizeTouchTargets(),this.setupPullToRefresh(),this.setupInfiniteScroll(),this.optimizeViewport()},optimizeTouchTargets:function(){document.querySelectorAll('a, button, input, select, textarea, [role="button"]').forEach(t=>{const e=t.getBoundingClientRect();(e.width<44||e.height<44)&&(t.style.minWidth="44px",t.style.minHeight="44px",t.style.padding="8px")})},setupPullToRefresh:function(){let t=0,e=0,i=!1;const n=document.createElement("div");n.className="pull-to-refresh-indicator",n.innerHTML='<div class="spinner"></div>',n.style.cssText="\n        position: fixed;\n        top: -60px;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 40px;\n        height: 40px;\n        background: white;\n        border-radius: 50%;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: top 0.3s;\n        z-index: 9999;\n      ",document.body.appendChild(n),document.addEventListener("touchstart",e=>{0===window.scrollY&&(t=e.touches[0].clientY,i=!0)}),document.addEventListener("touchmove",s=>{if(!i)return;e=s.touches[0].clientY;const o=e-t;if(o>0&&0===window.scrollY){s.preventDefault();const t=Math.min(o/100,1);n.style.top=60*t-60+"px",o>100?n.classList.add("ready"):n.classList.remove("ready")}}),document.addEventListener("touchend",()=>{i&&(e-t>100&&0===window.scrollY?(n.classList.add("refreshing"),this.triggerPullToRefresh(),setTimeout(()=>{n.classList.remove("refreshing","ready"),n.style.top="-60px"},1e3)):n.style.top="-60px",i=!1,t=0,e=0)})},setupInfiniteScroll:function(){let t=!1;const e=document.createElement("div");e.className="infinite-scroll-loader",e.innerHTML='<div class="spinner"></div>',e.style.cssText="\n        text-align: center;\n        padding: 20px;\n        display: none;\n      ",(document.querySelector("main")||document.body).appendChild(e),window.addEventListener("scroll",()=>{t||window.scrollY+window.innerHeight>document.documentElement.scrollHeight-200&&(t=!0,e.style.display="block",this.triggerInfiniteScroll(()=>{t=!1,e.style.display="none"}))})},optimizeViewport:function(){document.querySelectorAll("input, select, textarea").forEach(t=>{t.addEventListener("focus",()=>{document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")}),t.addEventListener("blur",()=>{document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width, initial-scale=1.0")})})},preventDefaultGestures:function(){document.querySelectorAll("img").forEach(t=>{t.addEventListener("touchmove",t=>{t.touches.length>1&&t.preventDefault()})})},triggerSwipeLeft:function(t){this.vibrate(),this.log("Swipe left detected"),this.executeHandlers("swipeLeft",t)},triggerSwipeRight:function(t){this.vibrate(),this.log("Swipe right detected"),this.executeHandlers("swipeRight",t)},triggerSwipeUp:function(t){this.vibrate(),this.log("Swipe up detected"),this.executeHandlers("swipeUp",t)},triggerSwipeDown:function(t){this.vibrate(),this.log("Swipe down detected"),this.executeHandlers("swipeDown",t)},triggerPinchIn:function(t,e){this.log("Pinch in detected",e),this.executeHandlers("pinchIn",t,e)},triggerPinchOut:function(t,e){this.log("Pinch out detected",e),this.executeHandlers("pinchOut",t,e)},triggerLongPress:function(t){this.vibrate(50),this.log("Long press detected"),this.executeHandlers("longPress",t)},triggerDoubleTap:function(t){this.vibrate(25),this.log("Double tap detected"),this.executeHandlers("doubleTap",t)},triggerShake:function(t){this.log("Shake detected"),this.executeHandlers("shake",t)},triggerPullToRefresh:function(){this.log("Pull to refresh triggered"),setTimeout(()=>{window.location.reload()},500)},triggerInfiniteScroll:function(t){this.log("Infinite scroll triggered"),setTimeout(t,1e3)},handleOrientationChange:function(t,e){this.log("Orientation changed from",t,"to",e),document.body.classList.remove("orientation-0","orientation-90","orientation-180","orientation-270"),document.body.classList.add("orientation-"+Math.abs(e))},executeHandlers:function(t,e,...i){this.handlers[t].forEach(t=>{try{t(e,...i)}catch(t){console.error("Error executing gesture handler:",t)}})},vibrate:function(t=10){this.config.enableVibration&&navigator.vibrate&&navigator.vibrate(t)},log:function(...t){this.config.enableDebug&&console.log("[Mobile Gestures]",...t)},on:function(t,e){this.handlers[t]?this.handlers[t].push(e):console.warn("Unknown gesture:",t)},off:function(t,e){if(this.handlers[t]){const i=this.handlers[t].indexOf(e);i>-1&&this.handlers[t].splice(i,1)}},enable:function(){this.init()},disable:function(){const t=document.body;t.removeEventListener("touchstart",this.handleTouchStart),t.removeEventListener("touchmove",this.handleTouchMove),t.removeEventListener("touchend",this.handleTouchEnd),t.removeEventListener("touchcancel",this.clearTouchData)},getConfig:function(){return Object.assign({},this.config)},setConfig:function(t){Object.assign(this.config,t)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){t.init()}):t.init(),window.MobileGestures=t}();