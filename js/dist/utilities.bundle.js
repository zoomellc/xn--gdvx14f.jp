(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach(function(t){r(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function r(t,n,r){return(n=function(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function o(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function s(n,r,o,i){var s=r&&r.prototype instanceof l?r:l,d=Object.create(s.prototype);return a(d,"_invoke",function(n,r,o){var a,i,s,l=0,d=o||[],u=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,s=e,f.n=n,c}};function p(n,r){for(i=n,s=r,t=0;!u&&l&&!o&&t<d.length;t++){var o,a=d[t],p=f.p,h=a[2];n>3?(o=h===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,i=0))}if(o||n>1)return c;throw u=!0,r}return function(o,d,h){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,h),i=d,s=h;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=f.n<0)?s:n.call(r,f))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,o,i),!0),d}var c={};function l(){}function d(){}function u(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(a(t={},r,function(){return this}),t),p=u.prototype=l.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,a(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=u,a(p,"constructor",u),a(u,"constructor",d),d.displayName="GeneratorFunction",a(u,i,"GeneratorFunction"),a(p),a(p,i,"Generator"),a(p,r,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(o=function(){return{w:s,m:h}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,n,r){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},a(e,t,n,r)}function i(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)})}}!function(){"use strict";var e,t,r={config:{minSearchLength:2,maxResults:20,highlightClass:"search-highlight",searchDelay:300,cacheExpiry:36e5,storageKey:"searchIndex",popularKey:"popularSearches"},searchIndex:null,searchTimeout:null,searchHistory:[],popularSearches:[],init:function(){this.loadSearchIndex(),this.loadSearchHistory(),this.loadPopularSearches(),this.createSearchForm(),this.setupSearchListeners(),this.setupKeyboardShortcuts()},createSearchForm:function(){var e=this,t=document.getElementById("searchWrapper");if(t&&!t.querySelector(".search-form")){var n=document.createElement("div");n.className="search-form",n.innerHTML='\n        <form role="search" class="relative">\n          <input type="search" \n                 name="q" \n                 placeholder="記事を検索..." \n                 class="search-input w-full px-4 py-3 pr-12 text-gray-700 bg-gray-50 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:bg-white"\n                 autocomplete="off"\n                 aria-label="サイト内検索">\n          <button type="submit" \n                  class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"\n                  aria-label="検索">\n            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>\n            </svg>\n          </button>\n        </form>\n        <div class="search-suggestions mt-2 hidden"></div>\n        <div class="search-results mt-4"></div>\n      ',t.appendChild(n);var r=n.querySelector("form");r.addEventListener("submit",function(t){t.preventDefault();var n=r.querySelector('input[type="search"]'),o=n.value.trim();o.length>=e.config.minSearchLength&&e.performSearch(o,n)})}},loadSearchIndex:(t=s(o().m(function e(){var t,n,r;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!(t=this.getCachedIndex())){e.n=1;break}return this.searchIndex=t,e.a(2);case 1:return e.n=2,fetch("/index.json");case 2:if((n=e.v).ok){e.n=3;break}throw new Error("Failed to load search index");case 3:return e.n=4,n.json();case 4:r=e.v,this.searchIndex=this.processIndexData(r),this.setCachedIndex(this.searchIndex),e.n=6;break;case 5:e.p=5,e.v,this.generateIndexFromDOM();case 6:return e.a(2)}},e,this,[[0,5]])})),function(){return t.apply(this,arguments)}),getCachedIndex:function(){try{var e=localStorage.getItem(this.config.storageKey);if(!e)return null;var t=JSON.parse(e);return Date.now()-t.timestamp>this.config.cacheExpiry?(localStorage.removeItem(this.config.storageKey),null):t.index}catch(n){return null}},setCachedIndex:function(e){try{var t={index:e,timestamp:Date.now()};localStorage.setItem(this.config.storageKey,JSON.stringify(t))}catch(n){}},processIndexData:function(e){var t=this;return e.map(function(e){return{title:e.title||"",content:e.content||"",summary:e.summary||"",permalink:e.permalink||"",categories:e.categories||[],tags:e.tags||[],date:e.date||"",searchableText:t.createSearchableText(e)}})},createSearchableText:function(e){return[e.title,e.content,e.summary,(e.categories||[]).join(" "),(e.tags||[]).join(" ")].filter(Boolean).join(" ").toLowerCase()},generateIndexFromDOM:function(){var e=document.querySelectorAll("article, .post, .content");this.searchIndex=Array.from(e).map(function(e){var t,n,r=(null===(t=e.querySelector("h1, h2, .title"))||void 0===t?void 0:t.textContent)||"",o=e.textContent||"",a=(null===(n=e.querySelector("a"))||void 0===n?void 0:n.href)||"";return{title:r.trim(),content:o.trim(),permalink:a,searchableText:(r+" "+o).toLowerCase()}})},loadSearchHistory:function(){try{var e=localStorage.getItem("searchHistory");this.searchHistory=e?JSON.parse(e):[]}catch(t){this.searchHistory=[]}},saveSearchHistory:function(e){if(e&&!(e.length<this.config.minSearchLength)){this.searchHistory=this.searchHistory.filter(function(t){return t!==e}),this.searchHistory.unshift(e),this.searchHistory=this.searchHistory.slice(0,10);try{localStorage.setItem("searchHistory",JSON.stringify(this.searchHistory))}catch(t){}this.updatePopularSearches(e)}},loadPopularSearches:function(){try{var e=localStorage.getItem(this.config.popularKey);this.popularSearches=e?JSON.parse(e):[]}catch(t){this.popularSearches=[]}},updatePopularSearches:function(e){var t=this.popularSearches.find(function(t){return t.term===e});t?t.count++:this.popularSearches.push({term:e,count:1}),this.popularSearches.sort(function(e,t){return t.count-e.count}),this.popularSearches=this.popularSearches.slice(0,10);try{localStorage.setItem(this.config.popularKey,JSON.stringify(this.popularSearches))}catch(n){}},setupSearchListeners:function(){var e=this;document.querySelectorAll('input[type="search"], input[name="q"], .search-input').forEach(function(t){t.addEventListener("input",function(t){clearTimeout(e.searchTimeout);var n=t.target.value.trim();if(n.length<e.config.minSearchLength)return e.hideSearchResults(),void e.showSearchSuggestions(t.target);e.searchTimeout=setTimeout(function(){e.performSearch(n,t.target)},e.config.searchDelay)}),t.addEventListener("focus",function(t){t.target.value.trim()||e.showSearchSuggestions(t.target)}),t.addEventListener("blur",function(t){setTimeout(function(){e.hideSearchResults()},200)}),t.addEventListener("keydown",function(t){if("Enter"===t.key){t.preventDefault();var n=t.target.value.trim();n&&(e.saveSearchHistory(n),e.performFullSearch(n))}})}),document.querySelectorAll(".widget-search__form, .search-form").forEach(function(t){t.addEventListener("submit",function(n){n.preventDefault();var r=t.querySelector('input[type="search"], input[name="q"]');r&&r.value.trim()&&(e.saveSearchHistory(r.value.trim()),e.performFullSearch(r.value.trim()))})})},setupKeyboardShortcuts:function(){var e=this;document.addEventListener("keydown",function(t){if((t.ctrlKey||t.metaKey)&&"k"===t.key){t.preventDefault();var n=document.querySelector('input[type="search"], input[name="q"]');n&&(n.focus(),n.select())}"Escape"===t.key&&e.hideSearchResults()})},showSearchSuggestions:function(e){var t=this,n=this.getOrCreateResultsContainer(e);if(n.innerHTML="",this.popularSearches.length>0){var r=document.createElement("div");r.className="search-suggestions-section",r.innerHTML='<h4 class="text-sm font-semibold text-gray-600 dark:text-gray-400 mb-2">人気の検索キーワード</h4>';var o=document.createElement("ul");o.className="space-y-1",this.popularSearches.slice(0,5).forEach(function(n){var r=document.createElement("li");r.innerHTML='\n            <button class="w-full text-left px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors" data-search-term="'.concat(n.term,'">\n              <span class="text-gray-700 dark:text-gray-300">').concat(n.term,'</span>\n              <span class="text-xs text-gray-500 dark:text-gray-500 ml-2">(').concat(n.count,"回)</span>\n            </button>\n          "),r.querySelector("button").addEventListener("click",function(){e.value=n.term,t.performSearch(n.term,e)}),o.appendChild(r)}),r.appendChild(o),n.appendChild(r)}if(this.searchHistory.length>0){var a=document.createElement("div");a.className="search-suggestions-section mt-4",a.innerHTML='<h4 class="text-sm font-semibold text-gray-600 dark:text-gray-400 mb-2">最近の検索</h4>';var i=document.createElement("ul");i.className="space-y-1",this.searchHistory.slice(0,5).forEach(function(n){var r=document.createElement("li");r.innerHTML='\n            <button class="w-full text-left px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors flex items-center justify-between" data-search-term="'.concat(n,'">\n              <span class="text-gray-700 dark:text-gray-300">').concat(n,'</span>\n              <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n              </svg>\n            </button>\n          '),r.querySelector("button").addEventListener("click",function(){e.value=n,t.performSearch(n,e)}),i.appendChild(r)}),a.appendChild(i),n.appendChild(a)}n.style.display="block"},performSearch:function(e,t){if(this.searchIndex){var n=this.searchInIndex(e);this.displaySearchResults(n,e,t)}},searchInIndex:function(e){var t=e.toLowerCase(),r=t.split(/\s+/).filter(Boolean);return this.searchIndex.map(function(e){var o=0;return e.title.toLowerCase()===t&&(o+=100),e.title.toLowerCase().includes(t)&&(o+=50),r.forEach(function(t){e.title.toLowerCase().includes(t)&&(o+=20),e.searchableText.includes(t)&&(o+=10),e.categories.some(function(e){return e.toLowerCase().includes(t)})&&(o+=15),e.tags.some(function(e){return e.toLowerCase().includes(t)})&&(o+=15)}),n(n({},e),{},{score:o})}).filter(function(e){return e.score>0}).sort(function(e,t){return t.score-e.score}).slice(0,this.config.maxResults)},displaySearchResults:function(e,t,n){var r=this,o=this.getOrCreateResultsContainer(n);if(o.innerHTML="",0===e.length)return o.innerHTML='\n          <div class="p-4 text-center text-gray-500 dark:text-gray-400">\n            「'.concat(t,"」に一致する結果が見つかりませんでした\n          </div>\n        "),void(o.style.display="block");var a=document.createElement("div");a.className="p-3 border-b border-gray-200 dark:border-gray-700",a.innerHTML='\n        <span class="text-sm text-gray-600 dark:text-gray-400">\n          '.concat(e.length,"件の結果が見つかりました\n        </span>\n      "),o.appendChild(a);var i=document.createElement("ul");i.className="divide-y divide-gray-200 dark:divide-gray-700",e.forEach(function(e){var n=document.createElement("li");n.className="hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors";var o=r.highlightText(e.title,t),a=r.createSnippet(e.content||e.summary,t);n.innerHTML='\n          <a href="'.concat(e.permalink,'" class="block p-3">\n            <h4 class="font-medium text-gray-900 dark:text-gray-100 mb-1">\n              ').concat(o,"\n            </h4>\n            ").concat(a?'<p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-2">'.concat(a,"</p>"):"","\n            ").concat(e.categories.length>0?'\n              <div class="mt-1 flex flex-wrap gap-1">\n                '.concat(e.categories.map(function(e){return'\n                  <span class="text-xs px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded">\n                    '.concat(e,"\n                  </span>\n                ")}).join(""),"\n              </div>\n            "):"","\n          </a>\n        "),i.appendChild(n)}),o.appendChild(i),o.style.display="block"},highlightText:function(e,t){if(!e||!t)return e;var n=new RegExp("(".concat(t.split(/\s+/).join("|"),")"),"gi");return e.replace(n,'<mark class="bg-yellow-200 dark:bg-yellow-800">$1</mark>')},createSnippet:function(e,t){if(!e||!t)return"";var n=t.toLowerCase(),r=e.toLowerCase(),o=r.indexOf(n);if(-1===o){var a=t.split(/\s+/)[0].toLowerCase(),i=r.indexOf(a);if(-1!==i){var s=Math.max(0,i-50),c=Math.min(e.length,i+100);return"..."+this.highlightText(e.substring(s,c),t)+"..."}return e.substring(0,150)+"..."}var l=Math.max(0,o-50),d=Math.min(e.length,o+100),u=e.substring(l,d);return(l>0?"...":"")+this.highlightText(u,t)+(d<e.length?"...":"")},getOrCreateResultsContainer:function(e){var t=e.parentElement.querySelector(".search-results-container");return t||((t=document.createElement("div")).className="search-results-container absolute z-50 w-full mt-1 bg-white dark:bg-gray-900 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 max-h-96 overflow-y-auto",t.style.display="none",e.parentElement.style.position="relative",e.parentElement.appendChild(t)),t},hideSearchResults:function(){document.querySelectorAll(".search-results-container").forEach(function(e){e.style.display="none"})},performFullSearch:function(e){window.location.href="/search?q=".concat(encodeURIComponent(e))},refreshIndex:(e=s(o().m(function e(){return o().w(function(e){for(;;)switch(e.n){case 0:return localStorage.removeItem(this.config.storageKey),e.n=1,this.loadSearchIndex();case 1:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){r.init()}):r.init(),window.Search=r,window.SiteSearch=r}()})(),(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){var e,t,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function s(n,o,a,i){var s=o&&o.prototype instanceof l?o:l,d=Object.create(s.prototype);return r(d,"_invoke",function(n,r,o){var a,i,s,l=0,d=o||[],u=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,s=e,f.n=n,c}};function p(n,r){for(i=n,s=r,t=0;!u&&l&&!o&&t<d.length;t++){var o,a=d[t],p=f.p,h=a[2];n>3?(o=h===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,i=0))}if(o||n>1)return c;throw u=!0,r}return function(o,d,h){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,h),i=d,s=h;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=f.n<0)?s:n.call(r,f))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,a,i),!0),d}var c={};function l(){}function d(){}function u(){}t=Object.getPrototypeOf;var f=[][a]?t(t([][a]())):(r(t={},a,function(){return this}),t),p=u.prototype=l.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,r(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=u,r(p,"constructor",u),r(u,"constructor",d),d.displayName="GeneratorFunction",r(u,i,"GeneratorFunction"),r(p),r(p,i,"Generator"),r(p,a,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:s,m:h}})()}function r(e,t,n,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}r=function(e,t,n,o){function i(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},r(e,t,n,o)}function o(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}!function(){"use strict";var e=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.favorites=[],this.storageKey="keigo-jp-favorites",this.maxFavorites=100,this.init()},r=[{key:"init",value:(i=n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:this.loadFavorites(),this.setupUI(),this.attachEventListeners(),this.updateFavoriteButtons();case 1:return e.a(2)}},e,this)}),s=function(){var e=this,t=arguments;return new Promise(function(n,r){var a=i.apply(e,t);function s(e){o(a,n,r,s,c,"next",e)}function c(e){o(a,n,r,s,c,"throw",e)}s(void 0)})},function(){return s.apply(this,arguments)})},{key:"loadFavorites",value:function(){var e=localStorage.getItem(this.storageKey);if(e)try{this.favorites=JSON.parse(e)}catch(t){this.favorites=[]}}},{key:"saveFavorites",value:function(){localStorage.setItem(this.storageKey,JSON.stringify(this.favorites))}},{key:"isFavorite",value:function(e){return this.favorites.some(function(t){return t.id===e})}},{key:"toggleFavorite",value:function(e){var t=this.favorites.findIndex(function(t){return t.id===e.id});if(t>-1)this.favorites.splice(t,1),this.onFavoriteRemoved(e);else{if(this.favorites.length>=this.maxFavorites)return void this.showMessage("お気に入りの上限に達しました。既存のお気に入りを削除してください。");this.favorites.unshift({id:e.id,title:e.title,url:e.url,excerpt:e.excerpt,savedAt:(new Date).toISOString()}),this.onFavoriteAdded(e)}this.saveFavorites(),this.updateFavoriteButtons(),this.updateFavoritesList()}},{key:"onFavoriteAdded",value:function(e){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.active&&t.active.postMessage({type:"CACHE_ARTICLE",url:e.url})}),this.showMessage("お気に入りに追加しました")}},{key:"onFavoriteRemoved",value:function(e){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.active&&t.active.postMessage({type:"UNCACHE_ARTICLE",url:e.url})}),this.showMessage("お気に入りから削除しました")}},{key:"setupUI",value:function(){this.injectStyles(),this.createFavoriteButtons(),this.createFavoritesModal(),this.createMessageContainer()}},{key:"injectStyles",value:function(){var e=document.createElement("style");e.textContent="\n                .favorite-button {\n                    background: none;\n                    border: none;\n                    cursor: pointer;\n                    padding: 8px;\n                    border-radius: 50%;\n                    transition: all 0.3s ease;\n                    display: inline-flex;\n                    align-items: center;\n                    justify-content: center;\n                }\n                \n                .favorite-button:hover {\n                    background-color: rgba(59, 130, 246, 0.1);\n                }\n                \n                .favorite-button svg {\n                    width: 24px;\n                    height: 24px;\n                    fill: none;\n                    stroke: #6b7280;\n                    stroke-width: 2;\n                    transition: all 0.3s ease;\n                }\n                \n                .favorite-button.is-favorite svg {\n                    fill: #f59e0b;\n                    stroke: #f59e0b;\n                }\n                \n                .favorites-modal {\n                    position: fixed;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    bottom: 0;\n                    background-color: rgba(0, 0, 0, 0.5);\n                    display: none;\n                    z-index: 1000;\n                    padding: 20px;\n                    overflow-y: auto;\n                }\n                \n                .favorites-modal.show {\n                    display: block;\n                }\n                \n                .favorites-modal-content {\n                    background-color: var(--bg-color, #ffffff);\n                    color: var(--text-color, #000000);\n                    max-width: 600px;\n                    margin: 0 auto;\n                    padding: 30px;\n                    border-radius: 10px;\n                    position: relative;\n                }\n                \n                .favorites-modal-header {\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    margin-bottom: 20px;\n                }\n                \n                .favorites-modal-close {\n                    background: none;\n                    border: none;\n                    font-size: 24px;\n                    cursor: pointer;\n                    color: var(--text-color, #000000);\n                }\n                \n                .favorites-list {\n                    list-style: none;\n                    padding: 0;\n                    margin: 0;\n                }\n                \n                .favorites-list-item {\n                    padding: 15px;\n                    border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: start;\n                }\n                \n                .favorites-list-item:last-child {\n                    border-bottom: none;\n                }\n                \n                .favorites-item-content {\n                    flex: 1;\n                    margin-right: 10px;\n                }\n                \n                .favorites-item-title {\n                    font-weight: bold;\n                    margin-bottom: 5px;\n                    color: var(--link-color, #3b82f6);\n                    text-decoration: none;\n                    display: block;\n                }\n                \n                .favorites-item-title:hover {\n                    text-decoration: underline;\n                }\n                \n                .favorites-item-excerpt {\n                    font-size: 14px;\n                    color: var(--text-color-secondary, #6b7280);\n                    margin-bottom: 5px;\n                }\n                \n                .favorites-item-date {\n                    font-size: 12px;\n                    color: var(--text-color-secondary, #9ca3af);\n                }\n                \n                .favorites-empty {\n                    text-align: center;\n                    padding: 40px;\n                    color: var(--text-color-secondary, #6b7280);\n                }\n                \n                .favorites-fab {\n                    position: fixed;\n                    bottom: 80px;\n                    right: 20px;\n                    background-color: #f59e0b;\n                    color: white;\n                    border: none;\n                    border-radius: 50%;\n                    width: 56px;\n                    height: 56px;\n                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n                    cursor: pointer;\n                    z-index: 999;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    transition: transform 0.3s ease;\n                }\n                \n                .favorites-fab:hover {\n                    transform: scale(1.1);\n                }\n                \n                .favorites-message {\n                    position: fixed;\n                    top: 20px;\n                    left: 50%;\n                    transform: translateX(-50%);\n                    background-color: var(--bg-color, #1f2937);\n                    color: var(--text-color, #ffffff);\n                    padding: 12px 24px;\n                    border-radius: 8px;\n                    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n                    z-index: 2000;\n                    opacity: 0;\n                    transition: opacity 0.3s ease;\n                }\n                \n                .favorites-message.show {\n                    opacity: 1;\n                }\n                \n                .favorites-export-section {\n                    margin-bottom: 20px;\n                    text-align: right;\n                }\n                \n                .favorites-export-button {\n                    background-color: #3b82f6;\n                    color: white;\n                    border: none;\n                    padding: 8px 16px;\n                    border-radius: 6px;\n                    cursor: pointer;\n                    font-size: 14px;\n                    transition: background-color 0.3s ease;\n                }\n                \n                .favorites-export-button:hover {\n                    background-color: #2563eb;\n                }\n                \n                .favorites-export-options {\n                    position: absolute;\n                    right: 30px;\n                    margin-top: 5px;\n                    background-color: var(--bg-color, #ffffff);\n                    border: 1px solid rgba(0, 0, 0, 0.1);\n                    border-radius: 6px;\n                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n                    z-index: 1001;\n                }\n                \n                .export-option {\n                    display: block;\n                    width: 100%;\n                    padding: 10px 20px;\n                    border: none;\n                    background: none;\n                    color: var(--text-color, #000000);\n                    cursor: pointer;\n                    text-align: left;\n                    font-size: 14px;\n                    transition: background-color 0.2s ease;\n                }\n                \n                .export-option:hover {\n                    background-color: rgba(59, 130, 246, 0.1);\n                }\n                \n                .export-option:first-child {\n                    border-radius: 6px 6px 0 0;\n                }\n                \n                .export-option:last-child {\n                    border-radius: 0 0 6px 6px;\n                }\n            ",document.head.appendChild(e)}},{key:"createFavoriteButtons",value:function(){var e=this;document.querySelectorAll("article, .article-item, .post-item").forEach(function(t){var n=t.querySelector("h1, h2, h3, .article-title, .post-title"),r=t.querySelector("a");if(n&&r){var o,a=document.createElement("button");a.className="favorite-button",a.innerHTML='\n                        <svg viewBox="0 0 24 24">\n                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>\n                        </svg>\n                    ';var i=null===(o=t.querySelector(".excerpt, .summary, p"))||void 0===o||null===(o=o.textContent)||void 0===o?void 0:o.trim(),s={id:r.href,title:n.textContent.trim(),url:r.href,excerpt:i?i.substring(0,100)+"...":""};a.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e.toggleFavorite(s)}),n.parentNode.insertBefore(a,n.nextSibling)}})}},{key:"createFavoritesModal",value:function(){var e=this,t=document.createElement("div");t.className="favorites-modal",t.innerHTML='\n                <div class="favorites-modal-content">\n                    <div class="favorites-modal-header">\n                        <h2>お気に入り記事</h2>\n                        <button class="favorites-modal-close">&times;</button>\n                    </div>\n                    <div class="favorites-export-section">\n                        <button class="favorites-export-button">エクスポート</button>\n                        <div class="favorites-export-options" style="display: none;">\n                            <button class="export-option" data-format="json">JSON形式</button>\n                            <button class="export-option" data-format="csv">CSV形式</button>\n                            <button class="export-option" data-format="markdown">Markdown形式</button>\n                            <button class="export-option" data-format="html">HTML形式</button>\n                        </div>\n                    </div>\n                    <div class="favorites-list-container"></div>\n                </div>\n            ',document.body.appendChild(t),this.modal=t,this.modalContent=t.querySelector(".favorites-list-container"),t.querySelector(".favorites-modal-close").addEventListener("click",function(){e.hideModal()}),t.addEventListener("click",function(n){n.target===t&&e.hideModal()});var n=t.querySelector(".favorites-export-button"),r=t.querySelector(".favorites-export-options");n.addEventListener("click",function(e){e.stopPropagation(),r.style.display="none"===r.style.display?"block":"none"}),t.querySelectorAll(".export-option").forEach(function(t){t.addEventListener("click",function(t){var n=t.target.dataset.format;e.exportFavorites(n),r.style.display="none"})}),t.querySelector(".favorites-modal-content").addEventListener("click",function(){r.style.display="none"})}},{key:"createMessageContainer",value:function(){var e=document.createElement("div");e.className="favorites-message",document.body.appendChild(e),this.messageContainer=e}},{key:"showMessage",value:function(e){var t=this;this.messageContainer.textContent=e,this.messageContainer.classList.add("show"),setTimeout(function(){t.messageContainer.classList.remove("show")},3e3)}},{key:"attachEventListeners",value:function(){var e=this,t=document.createElement("button");t.className="favorites-fab",t.innerHTML='\n                <svg width="24" height="24" viewBox="0 0 24 24" fill="white">\n                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>\n                </svg>\n            ',t.addEventListener("click",function(){e.showModal()}),document.body.appendChild(t),document.addEventListener("keydown",function(t){"Escape"===t.key&&e.modal.classList.contains("show")&&e.hideModal()})}},{key:"updateFavoriteButtons",value:function(){var e=this;document.querySelectorAll(".favorite-button").forEach(function(t){var n=t.closest("article, .article-item, .post-item"),r=null==n?void 0:n.querySelector("a");if(r){var o=e.isFavorite(r.href);t.classList.toggle("is-favorite",o)}})}},{key:"updateFavoritesList",value:function(){var e=this;if(this.modalContent)if(0!==this.favorites.length){var t=document.createElement("ul");t.className="favorites-list",this.favorites.forEach(function(n){var r=document.createElement("li");r.className="favorites-list-item";var o=new Date(n.savedAt).toLocaleDateString("ja-JP");r.innerHTML='\n                    <div class="favorites-item-content">\n                        <a href="'.concat(n.url,'" class="favorites-item-title">').concat(n.title,'</a>\n                        <div class="favorites-item-excerpt">').concat(n.excerpt,'</div>\n                        <div class="favorites-item-date">保存日: ').concat(o,'</div>\n                    </div>\n                    <button class="favorite-button is-favorite" data-id="').concat(n.id,'">\n                        <svg viewBox="0 0 24 24">\n                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>\n                        </svg>\n                    </button>\n                '),r.querySelector(".favorite-button").addEventListener("click",function(t){t.preventDefault(),e.toggleFavorite(n)}),t.appendChild(r)}),this.modalContent.innerHTML="",this.modalContent.appendChild(t)}else this.modalContent.innerHTML='<div class="favorites-empty">お気に入り記事がありません</div>'}},{key:"showModal",value:function(){this.updateFavoritesList(),this.modal.classList.add("show"),document.body.style.overflow="hidden"}},{key:"hideModal",value:function(){this.modal.classList.remove("show"),document.body.style.overflow=""}},{key:"exportFavorites",value:function(e){if(0!==this.favorites.length){var t="",n="keigo-jp-favorites-".concat((new Date).toISOString().split("T")[0]),r="text/plain";switch(e){case"json":t=JSON.stringify(this.favorites,null,2),n+=".json",r="application/json";break;case"csv":t=this.generateCSV(),n+=".csv",r="text/csv";break;case"markdown":t=this.generateMarkdown(),n+=".md",r="text/markdown";break;case"html":t=this.generateHTML(),n+=".html",r="text/html"}this.downloadFile(t,n,r),this.showMessage("".concat(e.toUpperCase(),"形式でエクスポートしました"))}else this.showMessage("エクスポートする記事がありません")}},{key:"generateCSV",value:function(){var e=this.favorites.map(function(e){return['"'.concat(e.title.replace(/"/g,'""'),'"'),e.url,'"'.concat(e.excerpt.replace(/"/g,'""'),'"'),new Date(e.savedAt).toLocaleDateString("ja-JP")]});return[["タイトル","URL","概要","保存日"].join(",")].concat(function(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.map(function(e){return e.join(",")}))).join("\n")}},{key:"generateMarkdown",value:function(){var e="# 敬語.jp お気に入り記事\n\n";return e+="エクスポート日: ".concat((new Date).toLocaleDateString("ja-JP"),"\n\n"),this.favorites.forEach(function(t,n){e+="## ".concat(n+1,". ").concat(t.title,"\n\n"),e+="- **URL**: [".concat(t.url,"](").concat(t.url,")\n"),e+="- **概要**: ".concat(t.excerpt,"\n"),e+="- **保存日**: ".concat(new Date(t.savedAt).toLocaleDateString("ja-JP"),"\n\n")}),e}},{key:"generateHTML",value:function(){return'<!DOCTYPE html>\n<html lang="ja">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>敬語.jp お気に入り記事</title>\n    <style>\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n            line-height: 1.6;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background-color: #f5f5f5;\n        }\n        h1 {\n            color: #333;\n            border-bottom: 2px solid #3b82f6;\n            padding-bottom: 10px;\n        }\n        .article {\n            background: white;\n            padding: 20px;\n            margin-bottom: 20px;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n        .article-title {\n            font-size: 1.2em;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .article-title a {\n            color: #3b82f6;\n            text-decoration: none;\n        }\n        .article-title a:hover {\n            text-decoration: underline;\n        }\n        .article-excerpt {\n            color: #666;\n            margin-bottom: 10px;\n        }\n        .article-date {\n            color: #999;\n            font-size: 0.9em;\n        }\n        .export-info {\n            background: #e3f2fd;\n            padding: 10px;\n            border-radius: 4px;\n            margin-bottom: 20px;\n        }\n    </style>\n</head>\n<body>\n    <h1>敬語.jp お気に入り記事</h1>\n    <div class="export-info">\n        <p>エクスポート日: '.concat((new Date).toLocaleDateString("ja-JP"),"</p>\n        <p>記事数: ").concat(this.favorites.length,"件</p>\n    </div>\n    ").concat(this.favorites.map(function(e){return'\n        <div class="article">\n            <div class="article-title">\n                <a href="'.concat(e.url,'" target="_blank">').concat(e.title,'</a>\n            </div>\n            <div class="article-excerpt">').concat(e.excerpt,'</div>\n            <div class="article-date">保存日: ').concat(new Date(e.savedAt).toLocaleDateString("ja-JP"),"</div>\n        </div>\n    ")}).join(""),"\n</body>\n</html>")}},{key:"downloadFile",value:function(e,t,n){var r=new Blob([e],{type:n+";charset=utf-8"}),o=URL.createObjectURL(r),a=document.createElement("a");a.href=o,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}}],r&&a(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,i,s}();"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){new e}):new e}()})(),function(){"use strict";var e,t,n,r="keigo-jp-font-size",o="keigo-jp-line-height",a="keigo-jp-letter-spacing",i={fontSize:100,lineHeight:1.8,letterSpacing:.05};function s(){localStorage.setItem(r,i.fontSize),localStorage.setItem(o,i.lineHeight),localStorage.setItem(a,i.letterSpacing)}function c(){document.querySelectorAll(".content, article, main p, main li, main td, main th").forEach(function(e){var t=parseFloat(window.getComputedStyle(e).fontSize)*i.fontSize/100+"px";e.style.fontSize=t,e.style.lineHeight=i.lineHeight,e.style.letterSpacing=i.letterSpacing+"em"}),document.documentElement.style.setProperty("--custom-font-size",i.fontSize+"%"),document.documentElement.style.setProperty("--custom-line-height",i.lineHeight),document.documentElement.style.setProperty("--custom-letter-spacing",i.letterSpacing+"em")}function l(e){var t=i.fontSize+e;t>=80&&t<=140&&(i.fontSize=t,s(),c(),h(),p("フォントサイズが".concat(i.fontSize,"%に変更されました")))}function d(e){var t=Math.round(10*(i.lineHeight+e))/10;t>=1.4&&t<=2.2&&(i.lineHeight=t,s(),c(),h(),p("行間が".concat(i.lineHeight,"に変更されました")))}function u(e){var t=Math.round(100*(i.letterSpacing+e))/100;t>=0&&t<=.15&&(i.letterSpacing=t,s(),c(),h(),p("文字間隔が".concat(i.letterSpacing,"emに変更されました")))}function f(){i={fontSize:100,lineHeight:1.8,letterSpacing:.05},s(),c(),h(),p("読みやすさの設定がデフォルトに戻されました")}function p(e){var t=document.createElement("div");t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.className="sr-only",t.textContent=e,document.body.appendChild(t),setTimeout(function(){document.body.removeChild(t)},1e3)}function h(){var e,t,n,r,o,a,s=document.getElementById("font-size-display"),c=document.getElementById("line-height-display"),l=document.getElementById("letter-spacing-display");s&&(s.textContent=i.fontSize+"%"),c&&(c.textContent=i.lineHeight),l&&(l.textContent=i.letterSpacing+"em"),e=document.getElementById("decrease-font-size"),t=document.getElementById("increase-font-size"),n=document.getElementById("decrease-line-height"),r=document.getElementById("increase-line-height"),o=document.getElementById("decrease-letter-spacing"),a=document.getElementById("increase-letter-spacing"),e&&(e.disabled=i.fontSize<=80),t&&(t.disabled=i.fontSize>=140),n&&(n.disabled=i.lineHeight<=1.4),r&&(r.disabled=i.lineHeight>=2.2),o&&(o.disabled=i.letterSpacing<=0),a&&(a.disabled=i.letterSpacing>=.15)}function v(){var e,t=document.querySelector('[onclick="toggleDarkMode()"]');if(t&&!document.getElementById("open-readability-settings")){var n=((e=document.createElement("button")).id="open-readability-settings",e.className="readability-btn",e.setAttribute("aria-label","読みやすさの設定を開く"),e.innerHTML='\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                <circle cx="12" cy="12" r="3"></circle>\n                <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>\n            </svg>\n            <span class="readability-btn-text">読みやすさ</span>\n        ',e),r=document.createElement("span");r.className="text-white mx-2",r.setAttribute("aria-hidden","true"),r.textContent="|";var o=t.parentElement;o&&(o.appendChild(r),o.appendChild(n))}if(!document.getElementById("readability-panel")){var a=function(){var e=document.createElement("div");return e.id="readability-panel",e.className="readability-panel hidden",e.setAttribute("role","region"),e.setAttribute("aria-label","読みやすさの設定"),e.innerHTML='\n            <div class="readability-panel-header">\n                <h3>読みやすさの設定</h3>\n                <button id="close-readability-panel" class="close-btn" aria-label="閉じる">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n            </div>\n            <div class="readability-panel-content">\n                <div class="readability-setting">\n                    <label>フォントサイズ</label>\n                    <div class="setting-controls">\n                        <button id="decrease-font-size" class="control-btn" aria-label="フォントサイズを小さくする">\n                            <span aria-hidden="true">−</span>\n                        </button>\n                        <span id="font-size-display" class="setting-value">'.concat(i.fontSize,'%</span>\n                        <button id="increase-font-size" class="control-btn" aria-label="フォントサイズを大きくする">\n                            <span aria-hidden="true">＋</span>\n                        </button>\n                    </div>\n                </div>\n                <div class="readability-setting">\n                    <label>行間</label>\n                    <div class="setting-controls">\n                        <button id="decrease-line-height" class="control-btn" aria-label="行間を狭くする">\n                            <span aria-hidden="true">−</span>\n                        </button>\n                        <span id="line-height-display" class="setting-value">').concat(i.lineHeight,'</span>\n                        <button id="increase-line-height" class="control-btn" aria-label="行間を広くする">\n                            <span aria-hidden="true">＋</span>\n                        </button>\n                    </div>\n                </div>\n                <div class="readability-setting">\n                    <label>文字間隔</label>\n                    <div class="setting-controls">\n                        <button id="decrease-letter-spacing" class="control-btn" aria-label="文字間隔を狭くする">\n                            <span aria-hidden="true">−</span>\n                        </button>\n                        <span id="letter-spacing-display" class="setting-value">').concat(i.letterSpacing,'em</span>\n                        <button id="increase-letter-spacing" class="control-btn" aria-label="文字間隔を広くする">\n                            <span aria-hidden="true">＋</span>\n                        </button>\n                    </div>\n                </div>\n                <div class="readability-actions">\n                    <button id="reset-readability" class="reset-btn">デフォルトに戻す</button>\n                </div>\n            </div>\n        '),e}();document.body.appendChild(a)}c(),function(){var e,t,n,r,o,a,i,s=document.getElementById("open-readability-settings"),c=document.getElementById("close-readability-panel"),p=document.getElementById("readability-panel");s&&p&&s.addEventListener("click",function(){p.classList.toggle("hidden"),p.classList.contains("hidden")||c.focus()}),c&&p&&c.addEventListener("click",function(){p.classList.add("hidden"),s.focus()}),null===(e=document.getElementById("decrease-font-size"))||void 0===e||e.addEventListener("click",function(){return l(-10)}),null===(t=document.getElementById("increase-font-size"))||void 0===t||t.addEventListener("click",function(){return l(10)}),null===(n=document.getElementById("decrease-line-height"))||void 0===n||n.addEventListener("click",function(){return d(-.2)}),null===(r=document.getElementById("increase-line-height"))||void 0===r||r.addEventListener("click",function(){return d(.2)}),null===(o=document.getElementById("decrease-letter-spacing"))||void 0===o||o.addEventListener("click",function(){return u(-.05)}),null===(a=document.getElementById("increase-letter-spacing"))||void 0===a||a.addEventListener("click",function(){return u(.05)}),null===(i=document.getElementById("reset-readability"))||void 0===i||i.addEventListener("click",f),document.addEventListener("keydown",function(e){"Escape"===e.key&&p&&!p.classList.contains("hidden")&&(p.classList.add("hidden"),s.focus())}),document.addEventListener("click",function(e){!p||p.classList.contains("hidden")||p.contains(e.target)||e.target===s||s.contains(e.target)||p.classList.add("hidden")})}(),h()}e=localStorage.getItem(r),t=localStorage.getItem(o),n=localStorage.getItem(a),e&&(i.fontSize=parseInt(e)),t&&(i.lineHeight=parseFloat(t)),n&&(i.letterSpacing=parseFloat(n)),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",v):v()}();