!function(){"use strict";const e="keigo-jp-font-size",t="keigo-jp-line-height",n="keigo-jp-letter-spacing";let i={fontSize:100,lineHeight:1.8,letterSpacing:.05};function a(){localStorage.setItem(e,i.fontSize),localStorage.setItem(t,i.lineHeight),localStorage.setItem(n,i.letterSpacing)}function l(){document.querySelectorAll(".content, article, main p, main li, main td, main th").forEach(e=>{const t=parseFloat(window.getComputedStyle(e).fontSize)*i.fontSize/100+"px";e.style.fontSize=t,e.style.lineHeight=i.lineHeight,e.style.letterSpacing=i.letterSpacing+"em"}),document.documentElement.style.setProperty("--custom-font-size",i.fontSize+"%"),document.documentElement.style.setProperty("--custom-line-height",i.lineHeight),document.documentElement.style.setProperty("--custom-letter-spacing",i.letterSpacing+"em")}function s(e){const t=i.fontSize+e;t>=80&&t<=140&&(i.fontSize=t,a(),l(),u(),r(`フォントサイズが${i.fontSize}%に変更されました`))}function d(e){const t=Math.round(10*(i.lineHeight+e))/10;t>=1.4&&t<=2.2&&(i.lineHeight=t,a(),l(),u(),r(`行間が${i.lineHeight}に変更されました`))}function c(e){const t=Math.round(100*(i.letterSpacing+e))/100;t>=0&&t<=.15&&(i.letterSpacing=t,a(),l(),u(),r(`文字間隔が${i.letterSpacing}emに変更されました`))}function o(){i={fontSize:100,lineHeight:1.8,letterSpacing:.05},a(),l(),u(),r("読みやすさの設定がデフォルトに戻されました")}function r(e){const t=document.createElement("div");t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.className="sr-only",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},1e3)}function u(){const e=document.getElementById("font-size-display"),t=document.getElementById("line-height-display"),n=document.getElementById("letter-spacing-display");e&&(e.textContent=i.fontSize+"%"),t&&(t.textContent=i.lineHeight),n&&(n.textContent=i.letterSpacing+"em"),function(){const e=document.getElementById("decrease-font-size"),t=document.getElementById("increase-font-size"),n=document.getElementById("decrease-line-height"),a=document.getElementById("increase-line-height"),l=document.getElementById("decrease-letter-spacing"),s=document.getElementById("increase-letter-spacing");e&&(e.disabled=i.fontSize<=80),t&&(t.disabled=i.fontSize>=140),n&&(n.disabled=i.lineHeight<=1.4),a&&(a.disabled=i.lineHeight>=2.2),l&&(l.disabled=i.letterSpacing<=0),s&&(s.disabled=i.letterSpacing>=.15)}()}function g(){const e=document.querySelector('[onclick="toggleDarkMode()"]');if(e&&!document.getElementById("open-readability-settings")){const t=function(){const e=document.createElement("button");return e.id="open-readability-settings",e.className="readability-btn",e.setAttribute("aria-label","読みやすさの設定を開く"),e.innerHTML='\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                <circle cx="12" cy="12" r="3"></circle>\n                <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>\n            </svg>\n            <span class="readability-btn-text">読みやすさ</span>\n        ',e}(),n=document.createElement("span");n.className="text-white mx-2",n.setAttribute("aria-hidden","true"),n.textContent="|";const i=e.parentElement;i&&(i.appendChild(n),i.appendChild(t))}if(!document.getElementById("readability-panel")){const e=function(){const e=document.createElement("div");return e.id="readability-panel",e.className="readability-panel hidden",e.setAttribute("role","region"),e.setAttribute("aria-label","読みやすさの設定"),e.innerHTML=`\n            <div class="readability-panel-header">\n                <h3>読みやすさの設定</h3>\n                <button id="close-readability-panel" class="close-btn" aria-label="閉じる">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n            </div>\n            <div class="readability-panel-content">\n                <div class="readability-setting">\n                    <label>フォントサイズ</label>\n                    <div class="setting-controls">\n                        <button id="decrease-font-size" class="control-btn" aria-label="フォントサイズを小さくする">\n                            <span aria-hidden="true">−</span>\n                        </button>\n                        <span id="font-size-display" class="setting-value">${i.fontSize}%</span>\n                        <button id="increase-font-size" class="control-btn" aria-label="フォントサイズを大きくする">\n                            <span aria-hidden="true">＋</span>\n                        </button>\n                    </div>\n                </div>\n                <div class="readability-setting">\n                    <label>行間</label>\n                    <div class="setting-controls">\n                        <button id="decrease-line-height" class="control-btn" aria-label="行間を狭くする">\n                            <span aria-hidden="true">−</span>\n                        </button>\n                        <span id="line-height-display" class="setting-value">${i.lineHeight}</span>\n                        <button id="increase-line-height" class="control-btn" aria-label="行間を広くする">\n                            <span aria-hidden="true">＋</span>\n                        </button>\n                    </div>\n                </div>\n                <div class="readability-setting">\n                    <label>文字間隔</label>\n                    <div class="setting-controls">\n                        <button id="decrease-letter-spacing" class="control-btn" aria-label="文字間隔を狭くする">\n                            <span aria-hidden="true">−</span>\n                        </button>\n                        <span id="letter-spacing-display" class="setting-value">${i.letterSpacing}em</span>\n                        <button id="increase-letter-spacing" class="control-btn" aria-label="文字間隔を広くする">\n                            <span aria-hidden="true">＋</span>\n                        </button>\n                    </div>\n                </div>\n                <div class="readability-actions">\n                    <button id="reset-readability" class="reset-btn">デフォルトに戻す</button>\n                </div>\n            </div>\n        `,e}();document.body.appendChild(e)}l(),function(){const e=document.getElementById("open-readability-settings"),t=document.getElementById("close-readability-panel"),n=document.getElementById("readability-panel");e&&n&&e.addEventListener("click",()=>{n.classList.toggle("hidden"),n.classList.contains("hidden")||t.focus()}),t&&n&&t.addEventListener("click",()=>{n.classList.add("hidden"),e.focus()}),document.getElementById("decrease-font-size")?.addEventListener("click",()=>s(-10)),document.getElementById("increase-font-size")?.addEventListener("click",()=>s(10)),document.getElementById("decrease-line-height")?.addEventListener("click",()=>d(-.2)),document.getElementById("increase-line-height")?.addEventListener("click",()=>d(.2)),document.getElementById("decrease-letter-spacing")?.addEventListener("click",()=>c(-.05)),document.getElementById("increase-letter-spacing")?.addEventListener("click",()=>c(.05)),document.getElementById("reset-readability")?.addEventListener("click",o),document.addEventListener("keydown",t=>{"Escape"===t.key&&n&&!n.classList.contains("hidden")&&(n.classList.add("hidden"),e.focus())}),document.addEventListener("click",t=>{!n||n.classList.contains("hidden")||n.contains(t.target)||t.target===e||e.contains(t.target)||n.classList.add("hidden")})}(),u()}!function(){const a=localStorage.getItem(e),l=localStorage.getItem(t),s=localStorage.getItem(n);a&&(i.fontSize=parseInt(a)),l&&(i.lineHeight=parseFloat(l)),s&&(i.letterSpacing=parseFloat(s))}(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",g):g()}();