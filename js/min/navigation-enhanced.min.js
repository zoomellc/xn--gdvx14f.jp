!function(){"use strict";const e={elements:{header:null,nav:null,hamburger:null,mobileMenu:null,dropdowns:[],searchBtn:null,lastScrollTop:0,isSticky:!1,ticking:!1},config:{stickyOffset:100,hideOnScrollDown:!0,animationDuration:300,breakpoint:768},init(){this.cacheElements(),this.elements.header&&(this.setupStickyHeader(),this.setupMegaMenu(),this.setupMobileNavigation(),this.setupAccessibility(),this.setupScrollProgress(),this.bindEvents())},cacheElements(){this.elements.header=document.querySelector('header[role="banner"]'),this.elements.nav=document.querySelector('nav[role="navigation"]'),this.elements.hamburger=document.getElementById("hamburgerbtn"),this.elements.mobileMenu=document.getElementById("mobileMenu"),this.elements.dropdowns=document.querySelectorAll(".dropdown"),this.elements.searchBtn=document.querySelector(".search-toggle-btn")},setupStickyHeader(){const e=this.elements.header;if(!e)return;const t=document.createElement("div");t.classList.add("header-placeholder"),t.style.display="none",e.parentNode.insertBefore(t,e.nextSibling),this.elements.placeholder=t},setupMegaMenu(){this.elements.dropdowns.forEach(e=>{const t=e.querySelector(".dropdown-toggle"),n=e.querySelector(".dropdown-menu");if(!t||!n)return;n.classList.add("mega-menu");const s=this.createMegaMenuContent(e);s&&(n.innerHTML="",n.appendChild(s)),t.addEventListener("mouseenter",()=>this.showMegaMenu(e)),e.addEventListener("mouseleave",()=>this.hideMegaMenu(e)),t.addEventListener("focus",()=>this.showMegaMenu(e)),n.addEventListener("focusout",t=>{setTimeout(()=>{e.contains(document.activeElement)||this.hideMegaMenu(e)},100)})})},createMegaMenuContent(e){const t=document.createElement("div");return t.classList.add("mega-menu-wrapper","grid","grid-cols-1","md:grid-cols-3","gap-6","p-6"),[{title:"基礎から学ぶ",items:[{name:"敬語の基本",url:"/basics/",icon:"📚"},{name:"尊敬語",url:"/sonkeigo/",icon:"🙏"},{name:"謙譲語",url:"/kenjougo/",icon:"🤝"},{name:"丁寧語",url:"/teineigo/",icon:"💬"}]},{title:"シーン別",items:[{name:"ビジネス",url:"/business/",icon:"💼"},{name:"電話対応",url:"/phone/",icon:"📞"},{name:"メール",url:"/email/",icon:"✉️"},{name:"接客",url:"/service/",icon:"🏪"}]},{title:"学習ツール",items:[{name:"クイズ",url:"/quiz/",icon:"🎯"},{name:"変換ツール",url:"/converter/",icon:"🔄"},{name:"例文集",url:"/examples/",icon:"📝"},{name:"よくある間違い",url:"/mistakes/",icon:"⚠️"}]}].forEach(e=>{const n=document.createElement("div");n.classList.add("mega-menu-column");const s=document.createElement("h3");s.classList.add("font-semibold","text-gray-900","mb-3"),s.textContent=e.title,n.appendChild(s);const i=document.createElement("ul");i.classList.add("space-y-2"),e.items.forEach(e=>{const t=document.createElement("li"),n=document.createElement("a");n.href=e.url,n.classList.add("flex","items-center","space-x-2","text-gray-600","hover:text-blue-600","transition-colors");const s=document.createElement("span");s.textContent=e.icon,s.classList.add("text-lg");const o=document.createElement("span");o.textContent=e.name,n.appendChild(s),n.appendChild(o),t.appendChild(n),i.appendChild(t)}),n.appendChild(i),t.appendChild(n)}),t},showMegaMenu(e){const t=e.querySelector(".dropdown-menu");t&&(t.style.opacity="0",t.style.transform="translateY(-10px)",t.classList.remove("hidden"),requestAnimationFrame(()=>{t.style.transition="opacity 0.3s ease, transform 0.3s ease",t.style.opacity="1",t.style.transform="translateY(0)"}),e.querySelector(".dropdown-toggle")?.setAttribute("aria-expanded","true"))},hideMegaMenu(e){const t=e.querySelector(".dropdown-menu");t&&(t.style.opacity="0",t.style.transform="translateY(-10px)",setTimeout(()=>{t.classList.add("hidden")},300),e.querySelector(".dropdown-toggle")?.setAttribute("aria-expanded","false"))},setupMobileNavigation(){if(!this.elements.mobileMenu)return;const e=document.createElement("div");e.classList.add("mobile-menu-backdrop","fixed","inset-0","bg-black","bg-opacity-50","z-40","hidden"),document.body.appendChild(e),this.elements.backdrop=e,e.addEventListener("click",()=>this.toggleMobileMenu(!1)),this.setupSwipeGestures()},setupSwipeGestures(){let e=0,t=0;document.addEventListener("touchstart",t=>{e=t.changedTouches[0].screenX},{passive:!0}),document.addEventListener("touchend",e=>{t=e.changedTouches[0].screenX,this.handleSwipe()},{passive:!0}),this.handleSwipe=()=>{const n=t-e;Math.abs(n)>50&&(n>0&&e<50?this.toggleMobileMenu(!0):n<0&&this.elements.mobileMenu.classList.contains("active")&&this.toggleMobileMenu(!1))}},toggleMobileMenu(e){const t=this.elements.mobileMenu,n=this.elements.hamburger,s=this.elements.backdrop;if(void 0===e&&(e=!t.classList.contains("active")),e){t.classList.add("active"),s.classList.remove("hidden"),document.body.style.overflow="hidden",n?.setAttribute("aria-expanded","true"),n?.setAttribute("aria-label","メニューを閉じる");const e=n?.querySelector(".hamburger-icon");e&&e.classList.add("active")}else{t.classList.remove("active"),s.classList.add("hidden"),document.body.style.overflow="",n?.setAttribute("aria-expanded","false"),n?.setAttribute("aria-label","メニューを開く");const e=n?.querySelector(".hamburger-icon");e&&e.classList.remove("active")}},setupAccessibility(){this.elements.nav&&(document.addEventListener("keydown",e=>{"Escape"===e.key&&(this.toggleMobileMenu(!1),this.elements.dropdowns.forEach(e=>this.hideMegaMenu(e)))}),this.elements.dropdowns.forEach(e=>{const t=e.querySelector(".dropdown-toggle");t&&t.addEventListener("keydown",n=>{"Enter"!==n.key&&" "!==n.key||(n.preventDefault(),"true"===t.getAttribute("aria-expanded")?this.hideMegaMenu(e):this.showMegaMenu(e))})}))},setupScrollProgress(){const e=document.createElement("div");e.classList.add("scroll-progress-bar"),e.innerHTML='<div class="scroll-progress-fill"></div>',this.elements.header.appendChild(e),this.updateScrollProgress()},updateScrollProgress(){const e=(document.body.scrollTop||document.documentElement.scrollTop)/(document.documentElement.scrollHeight-document.documentElement.clientHeight)*100,t=document.querySelector(".scroll-progress-fill");t&&(t.style.width=e+"%")},bindEvents(){this.elements.hamburger?.addEventListener("click",()=>this.toggleMobileMenu()),window.addEventListener("scroll",()=>{this.elements.ticking||(window.requestAnimationFrame(()=>{this.handleScroll(),this.updateScrollProgress(),this.elements.ticking=!1}),this.elements.ticking=!0)}),window.addEventListener("resize",this.debounce(()=>{window.innerWidth>=this.config.breakpoint&&this.toggleMobileMenu(!1)},250))},handleScroll(){const e=window.pageYOffset||document.documentElement.scrollTop,t=this.elements.header,n=this.elements.placeholder;e>this.config.stickyOffset?(this.elements.isSticky||(this.elements.isSticky=!0,t.classList.add("sticky-nav"),n.style.display="block",n.style.height=t.offsetHeight+"px"),this.config.hideOnScrollDown&&(e>this.elements.lastScrollTop?t.classList.add("nav-hidden"):t.classList.remove("nav-hidden"))):this.elements.isSticky&&(this.elements.isSticky=!1,t.classList.remove("sticky-nav","nav-hidden"),n.style.display="none"),this.elements.lastScrollTop=e},debounce(e,t){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...s)},t)}}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>e.init()):e.init(),window.NavigationEnhanced=e}();