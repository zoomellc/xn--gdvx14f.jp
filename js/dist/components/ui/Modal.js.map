{"version":3,"file":"Modal.js","sourceRoot":"","sources":["../../../src/components/ui/Modal.ts"],"names":[],"mappings":"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","sourcesContent":["export interface ModalOptions {\n  title?: string;\n  content?: string | HTMLElement;\n  footer?: string | HTMLElement;\n  className?: string;\n  closeOnOverlay?: boolean;\n  closeOnEscape?: boolean;\n  width?: string;\n  maxWidth?: string;\n  onOpen?: () => void;\n  onClose?: () => void;\n  onConfirm?: () => void | Promise<void>;\n  onCancel?: () => void;\n  confirmText?: string;\n  cancelText?: string;\n  showCloseButton?: boolean;\n  showFooter?: boolean;\n}\n\nexport class Modal {\n  private container: HTMLElement | null = null;\n  private overlay: HTMLElement | null = null;\n  private modal: HTMLElement | null = null;\n  private options: ModalOptions;\n  private isOpen: boolean = false;\n  private previousFocus: HTMLElement | null = null;\n\n  constructor(options: ModalOptions = {}) {\n    this.options = {\n      closeOnOverlay: true,\n      closeOnEscape: true,\n      width: 'auto',\n      maxWidth: '600px',\n      confirmText: '確認',\n      cancelText: 'キャンセル',\n      showCloseButton: true,\n      showFooter: true,\n      ...options\n    };\n    \n    this.init();\n  }\n\n  private init(): void {\n    if (typeof document === 'undefined') return;\n\n    this.createModalStructure();\n    this.attachEventListeners();\n  }\n\n  private createModalStructure(): void {\n    this.container = document.createElement('div');\n    this.container.className = 'modal-container';\n    this.container.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      display: none;\n      z-index: 10000;\n    `;\n\n    this.overlay = document.createElement('div');\n    this.overlay.className = 'modal-overlay';\n    this.overlay.style.cssText = `\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(0, 0, 0, 0.5);\n      opacity: 0;\n      transition: opacity 0.3s ease;\n    `;\n\n    this.modal = document.createElement('div');\n    this.modal.className = `modal ${this.options.className || ''}`;\n    this.modal.setAttribute('role', 'dialog');\n    this.modal.setAttribute('aria-modal', 'true');\n    this.modal.style.cssText = `\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%) scale(0.9);\n      background-color: #fff;\n      border-radius: 8px;\n      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n      width: ${this.options.width};\n      max-width: ${this.options.maxWidth};\n      max-height: 90vh;\n      overflow: hidden;\n      opacity: 0;\n      transition: all 0.3s ease;\n    `;\n\n    this.updateModalContent();\n\n    this.container.appendChild(this.overlay);\n    this.container.appendChild(this.modal);\n    document.body.appendChild(this.container);\n  }\n\n  private updateModalContent(): void {\n    if (!this.modal) return;\n\n    let headerHTML = '';\n    if (this.options.title || this.options.showCloseButton) {\n      headerHTML = `\n        <div class=\"modal-header\" style=\"\n          padding: 20px;\n          border-bottom: 1px solid #e0e0e0;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n        \">\n          ${this.options.title ? `<h2 class=\"modal-title\" style=\"margin: 0; font-size: 18px; font-weight: 600;\">${this.options.title}</h2>` : '<div></div>'}\n          ${this.options.showCloseButton ? `\n            <button class=\"modal-close\" aria-label=\"閉じる\" style=\"\n              background: none;\n              border: none;\n              font-size: 24px;\n              cursor: pointer;\n              color: #666;\n              padding: 0;\n              width: 30px;\n              height: 30px;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              transition: color 0.2s;\n            \">&times;</button>\n          ` : ''}\n        </div>\n      `;\n    }\n\n    const bodyHTML = `\n      <div class=\"modal-body\" style=\"\n        padding: 20px;\n        overflow-y: auto;\n        max-height: calc(90vh - ${this.options.showFooter ? '140px' : '80px'});\n      \">\n        ${typeof this.options.content === 'string' ? this.options.content : ''}\n      </div>\n    `;\n\n    let footerHTML = '';\n    if (this.options.showFooter && (this.options.footer || this.options.onConfirm || this.options.onCancel)) {\n      footerHTML = `\n        <div class=\"modal-footer\" style=\"\n          padding: 20px;\n          border-top: 1px solid #e0e0e0;\n          display: flex;\n          justify-content: flex-end;\n          gap: 10px;\n        \">\n          ${this.options.footer ? \n            (typeof this.options.footer === 'string' ? this.options.footer : '') :\n            `\n              ${this.options.onCancel ? `\n                <button class=\"modal-cancel\" style=\"\n                  padding: 8px 16px;\n                  border: 1px solid #ccc;\n                  background-color: #fff;\n                  border-radius: 4px;\n                  cursor: pointer;\n                  font-size: 14px;\n                  transition: all 0.2s;\n                \">${this.options.cancelText}</button>\n              ` : ''}\n              ${this.options.onConfirm ? `\n                <button class=\"modal-confirm\" style=\"\n                  padding: 8px 16px;\n                  border: none;\n                  background-color: #1976d2;\n                  color: #fff;\n                  border-radius: 4px;\n                  cursor: pointer;\n                  font-size: 14px;\n                  transition: all 0.2s;\n                \">${this.options.confirmText}</button>\n              ` : ''}\n            `\n          }\n        </div>\n      `;\n    }\n\n    this.modal.innerHTML = headerHTML + bodyHTML + footerHTML;\n\n    if (typeof this.options.content !== 'string' && this.options.content) {\n      const body = this.modal.querySelector('.modal-body');\n      if (body) {\n        body.innerHTML = '';\n        body.appendChild(this.options.content);\n      }\n    }\n\n    if (typeof this.options.footer !== 'string' && this.options.footer && this.options.showFooter) {\n      const footer = this.modal.querySelector('.modal-footer');\n      if (footer) {\n        footer.innerHTML = '';\n        footer.appendChild(this.options.footer);\n      }\n    }\n  }\n\n  private attachEventListeners(): void {\n    if (!this.modal || !this.overlay) return;\n\n    const closeBtn = this.modal.querySelector('.modal-close');\n    if (closeBtn) {\n      closeBtn.addEventListener('click', () => this.close());\n    }\n\n    const cancelBtn = this.modal.querySelector('.modal-cancel');\n    if (cancelBtn) {\n      cancelBtn.addEventListener('click', () => {\n        if (this.options.onCancel) {\n          this.options.onCancel();\n        }\n        this.close();\n      });\n    }\n\n    const confirmBtn = this.modal.querySelector('.modal-confirm');\n    if (confirmBtn) {\n      confirmBtn.addEventListener('click', async () => {\n        if (this.options.onConfirm) {\n          try {\n            await this.options.onConfirm();\n            this.close();\n          } catch (error) {\n            console.error('Modal confirm error:', error);\n          }\n        } else {\n          this.close();\n        }\n      });\n    }\n\n    if (this.options.closeOnOverlay) {\n      this.overlay.addEventListener('click', () => this.close());\n    }\n\n    if (this.options.closeOnEscape) {\n      document.addEventListener('keydown', this.handleEscape);\n    }\n  }\n\n  private handleEscape = (e: KeyboardEvent): void => {\n    if (e.key === 'Escape' && this.isOpen) {\n      this.close();\n    }\n  };\n\n  open(): void {\n    if (!this.container || !this.overlay || !this.modal || this.isOpen) return;\n\n    this.previousFocus = document.activeElement as HTMLElement;\n    \n    this.container.style.display = 'block';\n    \n    requestAnimationFrame(() => {\n      if (this.overlay && this.modal) {\n        this.overlay.style.opacity = '1';\n        this.modal.style.opacity = '1';\n        this.modal.style.transform = 'translate(-50%, -50%) scale(1)';\n      }\n    });\n\n    this.isOpen = true;\n    document.body.style.overflow = 'hidden';\n\n    const focusableElements = this.modal.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n    if (focusableElements.length > 0) {\n      (focusableElements[0] as HTMLElement).focus();\n    }\n\n    if (this.options.onOpen) {\n      this.options.onOpen();\n    }\n  }\n\n  close(): void {\n    if (!this.container || !this.overlay || !this.modal || !this.isOpen) return;\n\n    this.overlay.style.opacity = '0';\n    this.modal.style.opacity = '0';\n    this.modal.style.transform = 'translate(-50%, -50%) scale(0.9)';\n\n    setTimeout(() => {\n      if (this.container) {\n        this.container.style.display = 'none';\n      }\n      \n      this.isOpen = false;\n      document.body.style.overflow = '';\n\n      if (this.previousFocus) {\n        this.previousFocus.focus();\n      }\n\n      if (this.options.onClose) {\n        this.options.onClose();\n      }\n    }, 300);\n  }\n\n  setOptions(options: Partial<ModalOptions>): void {\n    this.options = { ...this.options, ...options };\n    this.updateModalContent();\n  }\n\n  setContent(content: string | HTMLElement): void {\n    this.options.content = content;\n    this.updateModalContent();\n  }\n\n  setTitle(title: string): void {\n    this.options.title = title;\n    this.updateModalContent();\n  }\n\n  destroy(): void {\n    this.close();\n    if (this.options.closeOnEscape) {\n      document.removeEventListener('keydown', this.handleEscape);\n    }\n    if (this.container) {\n      this.container.remove();\n    }\n  }\n}\n\nexport function createModal(options: ModalOptions): Modal {\n  return new Modal(options);\n}\n\nexport function confirm(message: string, options: Partial<ModalOptions> = {}): Promise<boolean> {\n  return new Promise((resolve) => {\n    const modal = new Modal({\n      title: '確認',\n      content: message,\n      onConfirm: () => resolve(true),\n      onCancel: () => resolve(false),\n      ...options\n    });\n    modal.open();\n  });\n}\n\nexport function alert(message: string, options: Partial<ModalOptions> = {}): Promise<void> {\n  return new Promise((resolve) => {\n    const modal = new Modal({\n      title: 'お知らせ',\n      content: message,\n      showFooter: true,\n      onConfirm: () => resolve(),\n      cancelText: '',\n      ...options\n    });\n    modal.open();\n  });\n}"]}